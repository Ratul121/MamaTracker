<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capture App</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1><i class="fas fa-camera"></i> Capture App</h1>
                <div class="header-camera">
                    <div class="camera-preview-wrapper">
                        <video id="headerCameraPreview" autoplay muted playsinline></video>
                        <div id="cameraPreviewPlaceholder" class="camera-preview-placeholder">
                            <i class="fas fa-video-slash"></i>
                        </div>
                    </div>
                    <select id="headerCameraSelect" title="Select Camera">
                        <option value="">Loading cameras...</option>
                    </select>
                </div>
                <div class="header-actions">
                    <button id="minimizeBtn" class="btn btn-icon" title="Minimize to Tray">
                        <i class="fas fa-window-minimize"></i>
                    </button>
                    <button id="settingsBtn" class="btn btn-icon" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Quick Actions -->
            <section class="quick-actions">
                <h2>Quick Capture</h2>
                <div class="action-grid">
                    <button id="screenshotBtn" class="action-card">
                        <i class="fas fa-desktop"></i>
                        <span>Screenshot</span>
                        <small>Ctrl+Shift+F</small>
                    </button>
                    <button id="cameraBtn" class="action-card">
                        <i class="fas fa-camera"></i>
                        <span>Camera</span>
                        <small>Ctrl+Shift+C</small>
                    </button>
                    <button id="compositeBtn" class="action-card">
                        <i class="fas fa-object-group"></i>
                        <span>Composite</span>
                        <small>Screenshot + Camera</small>
                    </button>
                    <button id="intervalBtn" class="action-card">
                        <i class="fas fa-clock"></i>
                        <span>Interval Capture</span>
                        <small>Ctrl+Shift+I</small>
                    </button>
                    <button id="directoryBtn" class="action-card">
                        <i class="fas fa-folder"></i>
                        <span>Select Directory</span>
                        <small>Choose save location</small>
                    </button>
                </div>
            </section>

            <!-- Active Sessions -->
            <section class="active-sessions">
                <h2>Active Sessions</h2>
                <div id="sessionsContainer" class="sessions-container">
                    <div class="no-sessions">
                        <i class="fas fa-info-circle"></i>
                        <p>No active capture sessions</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Interval Capture Modal -->
    <div id="intervalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Start Interval Capture</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="intervalForm">
                    <div class="form-group">
                        <label for="sessionName">Session Name (Optional)</label>
                        <input type="text" id="sessionName" placeholder="My Capture Session">
                    </div>

                    <div class="form-group">
                        <label for="captureType">Capture Type</label>
                        <select id="captureType" required>
                            <option value="screenshot">Screenshot</option>
                            <option value="camera">Camera</option>
                            <option value="both">Both (Screenshot & Camera)</option>
                            <option value="composite">Composite (Camera Overlay)</option>
                        </select>
                    </div>

                    <div class="form-group" id="cameraGroup" style="display: none;">
                        <label for="cameraDevice">Camera Device</label>
                        <select id="cameraDevice">
                            <!-- Cameras will be populated here -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="intervalSeconds">Interval (seconds)</label>
                        <input type="number" id="intervalSeconds" min="5" max="3600" value="30" required>
                        <small>Minimum: 5 seconds, Maximum: 1 hour</small>
                    </div>

                    <div class="form-group">
                        <label for="maxCaptures">Maximum Captures (Optional)</label>
                        <input type="number" id="maxCaptures" min="1" placeholder="Unlimited">
                        <small>Leave empty for unlimited captures</small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelInterval">Cancel</button>
                        <button type="submit" class="btn btn-primary">Start Session</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="settingsForm">
                    <div class="settings-section">
                        <h4>Default Interval Capture Settings</h4>
                        <p class="settings-description">These settings will be used when automatically starting interval
                            captures.</p>

                        <div class="form-group">
                            <label for="defaultSessionName">Default Session Name</label>
                            <input type="text" id="defaultSessionName" placeholder="Auto Capture Session">
                        </div>

                        <div class="form-group">
                            <label for="defaultCaptureType">Default Capture Type</label>
                            <select id="defaultCaptureType">
                                <option value="screenshot">Screenshot</option>
                                <option value="camera">Camera</option>
                                <option value="both">Both (Screenshot & Camera)</option>
                                <option value="composite">Composite (Camera Overlay)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="defaultIntervalSeconds">Default Interval (seconds)</label>
                            <input type="number" id="defaultIntervalSeconds" min="5" max="3600" value="30">
                            <small>Minimum: 5 seconds, Maximum: 1 hour</small>
                        </div>

                        <div class="form-group">
                            <label for="defaultMaxCaptures">Default Maximum Captures</label>
                            <input type="number" id="defaultMaxCaptures" min="1" placeholder="Unlimited">
                            <small>Leave empty for unlimited captures</small>
                        </div>

                        <div class="form-group">
                            <label for="autoStartInterval">Auto-start Interval Capture</label>
                            <div class="toggle-control">
                                <input type="checkbox" id="autoStartInterval">
                                <label for="autoStartInterval" class="toggle-label"></label>
                                <span>Start interval capture automatically 10 seconds after app launch</span>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4>Camera Settings</h4>
                        <p class="settings-description">Configure camera settings for all capture types.</p>

                        <div class="form-group">
                            <label for="defaultCamera">Default Camera</label>
                            <select id="defaultCamera">
                                <!-- Cameras will be populated dynamically -->
                            </select>
                            <small>This camera will be used for all camera captures</small>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4>Permissions</h4>
                        <p class="settings-description">Manage application permissions.</p>

                        <div class="form-group">
                            <button type="button" id="resetPermissionsBtn" class="btn btn-secondary">
                                Reset Permission Status
                            </button>
                            <small>Use this if you've granted permissions but the app still asks for them</small>
                        </div>

                        <div class="form-group">
                            <button type="button" id="openPrivacySettingsBtn" class="btn btn-secondary">
                                Open Privacy Settings
                            </button>
                            <small>Open macOS System Settings to grant needed permissions</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelSettings">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- App Status Bar -->
    <div id="statusBar" class="status-bar">
        <div id="directoryStatus" class="status-item">
            <i class="fas fa-folder"></i>
            <span id="directoryStatusText">No directory set</span>
        </div>
        <div id="defaultIntervalStatus" class="status-item">
            <i class="fas fa-clock"></i>
            <span id="defaultIntervalStatusText">No default interval set</span>
        </div>
    </div>

    <script src="scripts/main.js"></script>
</body>

</html>